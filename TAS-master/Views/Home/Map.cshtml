<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoJSON Editor</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="~/leaflet/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin="" />

    <!-- Leaflet Draw CSS -->
    <link rel="stylesheet" href="~/leaflet-draw/dist/leaflet.draw.css" />

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Map CSS -->
    <link rel="stylesheet" href="~/Contents/css/Map/map.css" />
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo-section">
                <div class="logo">üìç</div>
                <div class="logo-text">
                    <h1 class="title_map">GeoJSON Editor</h1>
                    <p class="title_map">Create & edit geographic data</p>
                </div>
            </div>

            <div class="toolbar">
                <label class="btn btn-secondary">
                    üì§ Import
                    <input type="file" id="importFile" accept=".geojson,.json" class="hidden">
                </label>

                <button class="btn btn-primary" id="exportBtn">
                    üì• Export
                </button>

                <button class="btn btn-danger" id="clearBtn">
                    üóëÔ∏è Clear
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Map Panel -->
            <div class="map-panel">
                <div id="map"></div>
                <div id="loading" class="loading">
                    <div class="spinner"></div>
                    <p>Loading map...</p>
                </div>
            </div>

            <!-- Editor Panel -->
            <div class="editor-panel">
                <div class="editor-header">
                    <div class="editor-title">
                        ‚úèÔ∏è GeoJSON Code
                    </div>
                    <div class="feature-count" id="featureCount">0 features</div>
                </div>

                <textarea id="jsonEditor" placeholder="GeoJSON will appear here..." spellcheck="false"></textarea>

                <div class="editor-footer">
                    <p><strong>üí° Tips:</strong></p>
                    <p>‚Ä¢ Use drawing tools on the map to add features</p>
                    <p>‚Ä¢ Edit JSON directly and it updates in real-time</p>
                    <p>‚Ä¢ Click features on map to see properties</p>
                </div>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div id="statusMessage">Ready to create</div>
            <div class="status-right">
                <span id="mapStatus">Loading...</span>
                <span class="status-indicator">
                    <div class="status-dot"></div>
                    Online
                </span>
            </div>
        </div>
    </div>
    <script src="~/Contents/js/Map/map.js"></script>
    <script>
        // Application State
        let map = null;
        let drawnItems = null;
        let geojson = {
            type: "FeatureCollection",
            features: []
        };
        let isUpdatingFromMap = false;
        let isUpdatingFromEditor = false;
        let scriptsLoaded = 0;
    </script>

    <!-- Leaflet JS -->
    <script src="~/leaflet/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""
            onload="checkScriptsLoaded()"></script>

    <!-- Leaflet Draw JS -->
    <script src="~/leaflet-draw/dist/leaflet.draw.js"
            onload="checkScriptsLoaded()"></script>
</body>
</html>